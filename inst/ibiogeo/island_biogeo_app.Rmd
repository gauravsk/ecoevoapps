---
title: "Island Biogeography"
author: "Marcel Vaz"
output:
  html_document:
    theme: united
    toc: true
    toc_depth: 3
runtime: shiny
---

```{r, echo  = F}
library(tidyverse)
library(ecoevoapps)
knitr::opts_chunk$set(echo = FALSE)
# source("functions.R")
source("ibiogeo_constants.R")
```

```{r}
sidebarLayout(
        sidebarPanel(
            sliderInput(inputId = "D1",
                        label = "Distance from mainland (Island A)",
                        min = 1,
                        max = 8,
                        value = 1),
            sliderInput(inputId = "D2",
                        label = "Distance from mainland (Island B)",
                        min = 1,
                        max = 8,
                        value = 4),            
            sliderInput(inputId = "A1",
                        label = "Area of island A",
                        min = .1,
                        max = 4,
                        value = 1),
            sliderInput(inputId = "A2",
                        label = "Area of island B",
                        min = .1,
                        max = 4,
                        value = .5),
            sliderInput(inputId = "M",
                        label = "Number of species in the mainland",
                        min = 1,
                        max = 100,
                        value = 100),
            width=4),
        mainPanel(
            renderPlot({map()})
        )
)

map <- reactive({
  # generate plots based on input$bins from ui.R
  make_islands_map(tx = tx, ty = ty, txa = txa, tya = tya, 
                   txb = txb, tyb = tyb, D = c(input$D1, input$D2), A=c(input$A1,input$A2), M=input$M,k=0.015)
  # mapNrates(D=c(input$D1,input$D2),A=c(input$A1,input$A2),M=input$M,k=0.015)
})
    

```
